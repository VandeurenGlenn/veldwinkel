(()=>{new class DeviceApi{constructor(){globalThis.deviceApi=this}async hasFrontCam(){try{return await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}}),!0}catch(e){return!1}}async hasBackCam(){try{return await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}),!0}catch(e){return!1}}async _createCameraStream(e="environment"){if(!this._cameraStream)return(e=>{this._cameraStream=e;const a=e.getVideoTracks()[0];this._imageCapture=new ImageCapture(a)})(await navigator.mediaDevices.getUserMedia({video:{facingMode:e}}))}async _previewCamera(e,a){if(!e)throw Error("No target HTMLElement defined");this._cameraStream||await this._createCameraStream(a),e.srcObject=this._cameraStream}get camera(){return{preview:(e,a)=>this._previewCamera(e,a),takePhoto:async e=>{this._cameraStream||await this._createCameraStream(e);const a=await this._imageCapture.takePhoto();return this._cameraStream=null,a}}}}})();
